############################################################
# Dockerfile to build EPACTS

#FROM ubuntu:18.04
#FROM ubuntu:20.04
FROM openanalytics/r-base

USER root
RUN export DEBIAN_FRONTEND=noninteractive
RUN DEBIAN_FRONTEND=noninteractive apt-get update && apt-get install -y tzdata
RUN dpkg-reconfigure --frontend noninteractive tzdata
RUN apt-get update && apt-get install -y build-essential apt-utils
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y gnuplot
RUN apt-get install -y git zlib1g-dev ghostscript groff vim


RUN apt-get update && apt-get install -y gcc g++ automake
RUN apt-get update && apt-get install -y --no-install-recommends \
    r-base-core \
    r-recommended \
 	r-base

RUN apt-get update && apt-get install -y libtool

RUN mkdir /home/epacts && chmod 777 /home/epacts

RUN ln -s /usr/bin/gcc /usr/local/bin/gcc
RUN ln -s /usr/bin/g++ /usr/local/bin/g++

ENV PATH=/usr/local/bin:$PATH

RUN git clone https://github.com/statgen/EPACTS.git
RUN rm /EPACTS/src/pEmmax.h
RUN cp /home/asselta/ccappadona/software/EPACTS_SKATOh/pEmmax.h /EPACTS/src/

WORKDIR EPACTS
RUN autoreconf -vfi
RUN CC="gcc" CXX="g++" ./configure --prefix /home/epacts
RUN make -j 1
RUN make -j 1 install

ENV EPACTS_DIR=/home/epacts

